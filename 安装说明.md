# B 站视频转文本 Skill - 安装说明

> **面向学生：** 你只需对 Agent 说一句话即可完成安装，无需接触任何命令行概念。
>
> **面向 Agent：** 当用户要求安装本 skill 时，请严格按照下方「Agent 安装步骤」执行。

---

## 平台说明

本 skill 支持两种平台，**AI 能力由各自平台提供，无需单独配置 API**：

| 平台 | 安装目标路径 | AI 授权 |
|------|-------------|---------|
| **Cursor** | `~/.cursor/skills/bilibili-video-to-text` | Cursor Agent（需 Cursor Pro） |
| **OpenClaw** | `~/.openclaw/skills/bilibili-video-to-text` | OpenClaw 模型（按 OpenClaw 配置） |

---

## 学生操作（零技术门槛）

### Cursor 用户

1. 下载本 zip 包到「下载」文件夹
2. 解压：双击 zip 即可；若不解压，可对 Agent 说「帮我解压 bilibili-video-to-text.zip 到 Downloads」
3. 在 Cursor 中 **File → Open Folder**，选择解压后的文件夹
4. 对 Agent 说：

   > **帮我安装这个 B 站转文本 skill，按照「安装说明.md」里的 Agent 安装步骤执行**

5. 等待 Agent 完成所有步骤，安装完成后**重启 Cursor**

### OpenClaw 用户

1. 确保 OpenClaw 已安装并完成模型授权
2. 对 OpenClaw Agent 说「帮我安装 B 站转文本 skill」，或手动执行下方「OpenClaw 安装步骤」

---

## Agent 安装步骤

当用户要求安装本 skill 时，请按以下顺序执行。**根据当前平台选择目标路径**。

### 步骤 1：将 skill 移动到对应平台的 skills 目录

- **Cursor（Mac/Linux）：** `~/.cursor/skills/bilibili-video-to-text`
- **Cursor（Windows）：** `%USERPROFILE%\.cursor\skills\bilibili-video-to-text`
- **OpenClaw（Mac/Linux）：** `~/.openclaw/skills/bilibili-video-to-text`
- **OpenClaw（Windows）：** `%USERPROFILE%\.openclaw\skills\bilibili-video-to-text`

若当前工作区即本 skill 文件夹，则：
- 将整个 skill 文件夹**复制**到上述目标路径
- 若目标路径已存在同名文件夹，可先删除再复制，或直接覆盖

### 步骤 2：运行一键安装脚本

**Mac/Linux（以 Cursor 为例）：**
```bash
cd ~/.cursor/skills/bilibili-video-to-text
chmod +x setup.sh
./setup.sh
```

**OpenClaw 用户将路径改为：** `~/.openclaw/skills/bilibili-video-to-text`

**Windows（PowerShell）：**
```powershell
cd $env:USERPROFILE\.cursor\skills\bilibili-video-to-text
Set-ExecutionPolicy Bypass -Scope Process -Force
.\setup.ps1
```

### 步骤 3：环境检测

```bash
cd <skill 目录>
python scripts/check_env.py
```

- 若输出 JSON 中 `ready_for_subtitle` 为 `true`，则表示安装成功
- 若为 `false`，根据输出的 `install_commands` 安装缺失依赖（见下方依赖表）

### 步骤 4：告知用户

安装完成后告诉用户：
- Skill 已安装到对应平台的 skills 目录
- 使用方式：对 Agent 说「帮我把这个 B 站视频转成文字并生成摘要：<视频链接>」
- **Cursor 用户建议重启 Cursor** 以使 skill 生效

---

## 环境与依赖

### 环境检查（Mac / Windows）

| 依赖 | Mac | Windows |
|------|-----|---------|
| Python 3.10+ | `brew install python` | `winget install Python.Python.3.12` |
| ffmpeg | `brew install ffmpeg` | `choco install ffmpeg` |
| yt-dlp | `pip install yt-dlp` | `pip install yt-dlp` |
| Whisper（无字幕时） | `pip install openai-whisper` | 同上 |

`setup.sh`（Mac）和 `setup.ps1`（Windows）会自动检测并安装上述依赖。若自动安装失败，可根按上表手动安装。

### 首次使用建议

```bash
pip install -r requirements.txt
```

---

## 使用提示词（学生可对 Agent 说）

安装完成后，学生可对 Agent 说以下任意一句：

- 「帮我把这个 B 站视频转成文字并生成摘要：https://www.bilibili.com/video/BVxxxxx」
- 「把这个 B 站视频转成笔记：<链接>」
- 「提取这个视频的字幕并生成摘要：<链接>」

---

## Skill 限制与注意事项

1. **平台授权**：Cursor 需 Cursor Pro；OpenClaw 需在 OpenClaw 中完成模型授权。**无需单独配置 API**。
2. **视频时长**：建议 5–15 分钟；过长视频处理较慢
3. **字幕**：优先提取 CC 字幕；无字幕时需 Whisper 转写（首次会下载模型约 150MB）
4. **B 站登录**：部分视频字幕需登录，可尝试加参数 `--cookies-from-browser chrome`（或 safari）
5. **网络**：需能访问 B 站和 pip/brew 等安装源

---

## 故障排查

- **「没有字幕」**：安装 Whisper：`pip install openai-whisper`
- **「找不到命令」**：重启终端以刷新环境变量
- **Cursor Agent 不响应**：确认 Cursor Pro 会员有效
- **OpenClaw Agent 不响应**：确认 OpenClaw 模型已正确配置并授权

更多问题见 [reference.md](reference.md)。
